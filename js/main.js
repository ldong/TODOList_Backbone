!function(){window.App={Models:{},Collections:{},Views:{}},window.template=function(e){return _.template($("#"+e).html())},App.Models.Task=Backbone.Model.extend({validate:function(e){return e.title?void 0:"A taks requires a valid title"}}),App.Collections.Tasks=Backbone.Collection.extend({model:App.Models.Task}),App.Views.Task=Backbone.View.extend({tagName:"li",template:template("taskTemplate"),initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.destroy,this)},events:{"click .edit":"editTask","click .delete":"destroyTask"},editTask:function(){console.log(this.model.get("title"));var e=prompt("What would you like to change the next task to?",this.model.get("title"));this.model.set("title",$.trim(e),{validate:!0})},destroyTask:function(){this.model.destroy()},destroy:function(){this.$el.remove()},render:function(){var e=this.template(this.model.toJSON());return this.$el.html(e),this}}),App.Views.Tasks=Backbone.View.extend({tagName:"ul",initialize:function(){this.collection.on("add",this.addOne,this);var e=this;this.listenTo(Backbone.Events,"tasks:add",function(t){e.addOne(t)})},render:function(){return this.collection.each(this.addOne,this),this},addOne:function(e){var t=new App.Views.Task({model:e});this.$el.append(t.render().el)}}),App.Views.AddTask=Backbone.View.extend({el:"#addTask",initialize:function(){},events:{submit:"submit"},submit:function(e){e.preventDefault();var t=$(e.currentTarget).find("input[type=text]").val();console.log(t);var i=new App.Models.Task({title:t});Backbone.Events.trigger("tasks:add",i)}});var e=new App.Collections.Tasks([{title:"Go shopping",priority:4},{title:"Buy food",priority:5}]),t=new App.Views.Tasks({collection:e});$(".tasks").html(t.render().el),new App.Views.AddTask({collection:e})}();
